<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Segment Tracking System</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            width: 250px;
            background-color: #343a40;
            padding: 10px;
            transition: width 0.3s;
            overflow-x: hidden;
            z-index: 1000; /* Ensure the sidebar is above content */
        }
        .sidebar.collapsed {
            width: 0;
            padding: 0;
        }
        .sidebar .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .sidebar .nav-link {
            color: #fff;
        }
        .sidebar .nav-link:hover {
            background-color: #495057;
        }
        .collapse-button {
            background-color: #343a40;
            color: #fff;
            border: none;
            outline: none;
            position: fixed;
            top: 10px;
            left: 10px;
            z-index: 1000;
            transition: left 0.3s;
        }
        .content {
            margin-left: 250px;
            transition: margin-left 0.3s;
            min-height: calc(100vh - 60px); /* Adjust for footer height */
        }
        .content.collapsed {
            margin-left: 0;
        }
        footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            text-align: center;
            padding: 10px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
            z-index: 1000;
        }
        .top-right-images {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            display: flex;
            align-items: center;
        }
        .top-right-images img {
            height: 80px; /* Adjust the height as needed */
            width: 80px; /* Adjust the width as needed */
            margin-left: 10px; /* Space between images */
        }
    </style>
</head>
<body>
<!-- Sidebar -->
<div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <h4 class="text-white">M</h4>
        <button class="collapse-button" id="collapseButton">
            <span>&#9776;</span>
        </button>
    </div>
    <ul class="nav flex-column">
        <li class="nav-item">
            <a class="nav-link ajax-link" href="/materialTracking/entities" data-url="/materialTracking/entities">Barcode Label Generation</a>
        </li>
        <li class="nav-item">
            <a class="nav-link ajax-link" href="/materialTracking/segmentConfirmation" data-url="/materialTracking/segmentConfirmation">Segment Confirmation</a>
        </li>
        <li class="nav-item">
            <a class="nav-link ajax-link" href="/materialTracking/dispatchConfirmation" data-url="/materialTracking/dispatchConfirmation">Dispatch Confirmation</a>
        </li>
        <li class="nav-item">
            <a class="nav-link ajax-link" href="/materialTracking/receiveConfirmation" data-url="/materialTracking/receiveConfirmation">Receive Confirmation</a>
        </li>
        <li class="nav-item">
            <a class="nav-link ajax-link" href="/materialTracking/erectionConfirmation" data-url="/materialTracking/erectionConfirmation">Erection Confirmation</a>
        </li>
        <li class="nav-item">
            <a class="nav-link ajax-link" href="/materialTracking/segmentHistoryReport" data-url="/materialTracking/segmentHistoryReport">Segment History Report</a>
        </li>
    </ul>
</div>

<!-- Images at the top-right corner -->
<div class="top-right-images">
<!--    <img th:src="@{/images/paramount.jpg}" alt="Logo 1">-->
<!--    <img th:src="@{/images/paramount1.jpg}" alt="Logo 2">-->
</div>

<div class="content" id="content">
    <div class="container mt-5">
        <h1>Welcome to the Segment Tracking System</h1>
        <p>Use the sidebar to navigate through the application.</p>
    </div>
</div>

<!-- Footer -->
<!-- <footer>
    Powered by: Paramount Print Pack
</footer> -->

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
<script>
    $(document).ready(function() {
        // Apply saved state of the sidebar from localStorage
        if (localStorage.getItem('sidebarCollapsed') === 'true') {
            $('#sidebar').addClass('collapsed');
            $('#content').addClass('collapsed');
        }

        $('#collapseButton').on('click', function() {
            $('#sidebar').toggleClass('collapsed');
            $('#content').toggleClass('collapsed');

            // Save the current state of the sidebar in localStorage
            localStorage.setItem('sidebarCollapsed', $('#sidebar').hasClass('collapsed'));
        });

        $('.ajax-link').on('click', function(event) {
            event.preventDefault(); // Prevent the default link behavior

            var apiUrl = $(this).data('url'); // Get the API URL from data attribute

            $.ajax({
                url: apiUrl,
                method: 'GET',
                success: function(response) {
                    $('#content').html(response); // Load the returned HTML into the content area

                    // Update the browser URL
                    var newUrl = $(this).attr('href');
                    history.pushState(null, '', newUrl);

                    // Collapse the sidebar if the clicked link is one of the specified links
                    var linkText = $(this).text().trim();
                    var collapsibleLinks = [
                        'Segment Confirmation',
                        'Receive Confirmation',
                        'Dispatch Confirmation',
                        'Erection Confirmation'
                    ];
                    if (collapsibleLinks.includes(linkText)) {
                        $('#sidebar').addClass('collapsed');
                        $('#content').addClass('collapsed');
                        localStorage.setItem('sidebarCollapsed', 'true');
                    }
                }.bind(this), // Bind 'this' to preserve context for newUrl
                error: function() {
                    alert('An error occurred while loading the content.');
                }
            });
        });

        // Handle back/forward navigation
        window.onpopstate = function() {
            location.reload(); // Reload the page when navigating back/forward
        };
    });
</script>



</body>
</html>
